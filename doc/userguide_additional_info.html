<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Additional Information &#8212; CGNS Official Web Site</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/guzzle.css?v=ee5bbeb1" />
    <link rel="stylesheet" type="text/css" href="../_static/css/filemap.css?v=2c72f61b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/math_override.css?v=97141bf4" />
    <link rel="stylesheet" type="text/css" href="../_static/css/midlevel.css?v=593b94c8" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=117e2fac"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="icon" href="../_static/CGNS_empty.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
  <link rel="apple-touch-icon" href="../_static/CGNS_empty.svg" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">CGNS Official Web Site</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Additional Information</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">Additional Information</a><ul>
<li><a class="reference internal" href="#convergence-history">Convergence History</a></li>
<li><a class="reference internal" href="#descriptor-nodes">Descriptor Nodes</a></li>
<li><a class="reference internal" href="#dimensional-data">Dimensional Data</a></li>
<li><a class="reference internal" href="#nondimensional-data">Nondimensional Data</a></li>
<li><a class="reference internal" href="#flow-equation-sets">Flow Equation Sets</a></li>
<li><a class="reference internal" href="#time-dependent-data">Time-Dependent Data</a></li>
<li><a class="reference internal" href="#using-links">Using Links</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
              <li>Additional Information</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <section id="additional-information">
<h1>Additional Information<a class="headerlink" href="#additional-information" title="Permalink to this heading">¶</a></h1>
<p>This section introduces several additional types of data in CGNS. These items are by no means necessary to include when getting started, but it is likely that most users will eventually want to implement some of them into their CGNS files at some point in the future. The section ends with a discussion on the usage of links.</p>
<section id="convergence-history">
<h2>Convergence History<a class="headerlink" href="#convergence-history" title="Permalink to this heading">¶</a></h2>
<p>The ConvergenceHistory_t node can be used to store data associated with the convergence of a CFD solution. For example, one may wish to store the global coefficient of lift as a function of iterations. In this case, this variable should be stored at the CGNSBase_t level of the CGNS file. This is achieved using the API in the following FORTRAN code segment:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE CONVERGENCE HISTORY INFORMATION TO EXISTING CGNS FILE</span>
<span class="w">     </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   go to base node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   create history node (SIDS names it GlobalConvergenceHistory at base level)</span>
<span class="c">!   ntt is the number of recorded iterations</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_convergence_write_f</span><span class="p">(</span><span class="n">ntt</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to new history node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ConvergenceHistory_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   write lift coefficient array (user must use SIDS-standard name here)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;CoefLift&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ntt</span><span class="p">,</span><span class="n">cl</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the array cl must be declared as an array of size ntt or larger. Additional arrays of the same size may also be written under the ConvergenceHistory_t node. Note that the call to cg_convergence_write_f includes a blank string in this case, because we are not recording norm definitions.</p>
</section>
<section id="descriptor-nodes">
<h2>Descriptor Nodes<a class="headerlink" href="#descriptor-nodes" title="Permalink to this heading">¶</a></h2>
<p>Descriptor nodes, which record character strings and can be inserted nearly everywhere in a CGNS file, have many possible uses. Users can insert comments or descriptions to help clarify the content of some data in the CGNS file. In the SIDS overview section, we mention a possible use for descriptor nodes to describe data that is UserDefinedData_t. Another potentially desirable use of the descriptor node is to maintain copies of the entire input file(s) from the CFD application code. Because descriptor nodes can include carriage returns, entire ASCII files can be “swallowed” into the CGNS file. In this way, a future user can see and retrieve the exact input file(s) used by the CFD code to generate the data contained in the CGNS file. The only ambiguity possible would be whether the CFD code itself has changed since that time; but if the CFD code has strict version control, then complete recoverability should be possible.</p>
<p>An example that writes a descriptor node at the CGNSBase_t level is given here:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE DESCRIPTOR NODE AT BASE LEVEL</span>
<span class="w">     </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   go to base node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   write descriptor node (user can give any name)</span>
<span class="w">     </span><span class="n">text1</span><span class="o">=</span><span class="s1">&#39;Supersonic vehicle with landing gear&#39;</span>
<span class="w">     </span><span class="n">text2</span><span class="o">=</span><span class="s1">&#39;M=4.6, Re=6 million&#39;</span>
<span class="w">     </span><span class="n">textstring</span><span class="o">=</span><span class="n">text1</span><span class="o">//</span><span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">//</span><span class="n">text2</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_descriptor_write_f</span><span class="p">(</span><span class="s1">&#39;Information&#39;</span><span class="p">,</span><span class="n">textstring</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the Descriptor_t node is named Information and the character string textstring (which is made up of text1 and text2 with a line feed - char(10) - in-between) is written there. All character strings must be declared appropriately.</p>
</section>
<section id="dimensional-data">
<h2>Dimensional Data<a class="headerlink" href="#dimensional-data" title="Permalink to this heading">¶</a></h2>
<p>The node DataClass_t denotes the class of the data. When data is dimensional, then DataClass_t = Dimensional. The DataClass_t node can appear at many levels in the CGNS hierarchy; precedence rules dictate that a DataClass_t lower in the hierarchy supersedes any higher up.</p>
<p>For dimensional data, one generally is expected to indicate the dimensionality of each particular variable through the use of DataClass_t, DimensionalUnits_t, and DimensionalExponents_t. An example of this is shown in the following code segment in which units are added to the structured grid and cell center flow solution used previously.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE DIMENSIONAL INFO FOR GRID AND FLOW SOLN</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">     </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one FlowSolution_t (real working code would check!)</span>
<span class="w">     </span><span class="n">index_flow</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one GridCoordinates_t (real working code would check!)</span>
<span class="w">     </span><span class="n">index_grid</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   put DataClass and DimensionalUnits under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">Dimensional</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_units_write_f</span><span class="p">(</span><span class="n">Kilogram</span><span class="p">,</span><span class="n">Meter</span><span class="p">,</span><span class="nb">Second</span><span class="p">,</span><span class="n">Kelvin</span><span class="p">,</span><span class="n">Degree</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   read fields</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_nfields_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="n">nfields</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">do if</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nfields</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_field_info_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">    </span><span class="n">index_flow</span><span class="p">,</span><span class="k">if</span><span class="p">,</span><span class="n">idatatype</span><span class="p">,</span><span class="n">fieldname</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fieldname</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;Density&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="mf">3.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">       </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">fieldname</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=-</span><span class="mf">2.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">       </span><span class="k">else</span>
<span class="k">         write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Error! this fieldname not expected: &#39;&#39;,a32)&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="o">+</span><span class="w">      </span><span class="n">fieldname</span>
<span class="w">         </span><span class="k">stop</span>
<span class="k">       end if</span>
<span class="c">!   write DimensionalExponents</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;FlowSolution_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="k">if</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_exponents_write_f</span><span class="p">(</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">exponents</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">enddo</span>
<span class="c">!   read grid</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_ncoords_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">ncoords</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncoords</span>
<span class="c">!   write DimensionalExponents</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;GridCoordinates_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_exponents_write_f</span><span class="p">(</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">exponents</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">enddo</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice in this example that a DataClass_t node and a DimensionalUnits_t node are placed near the top of the hierarchy, under CGNSBase_t. DataClass_t is specified as Dimensional, and DimensionalUnits_t are specified as (Kilogram, Meter, Second, Kelvin, Degree). These specify that, by and large, the entire database is dimensional with MKS units (anything that is not dimensional or not MKS units could be superseded at lower levels). Then, for each variable locally, one need only specify the DimensionalExponents, where one exponent is defined for each unit.</p>
<p>The layout of part of the resulting CGNS file from the above example is shown below. The density has units of kilogram/meter3, and the pressure has units of kilogram/(meter-second2). The grid coordinates (not shown in the figure) have units of meters.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/tree_dimensional.gif"><img alt="Diagram showing CGNS layout for flow solution at cell centers with dimensional data" src="../_images/tree_dimensional.gif" style="width: 168px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file for flow solution at cell centers with dimensional data.</em></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="nondimensional-data">
<h2>Nondimensional Data<a class="headerlink" href="#nondimensional-data" title="Permalink to this heading">¶</a></h2>
<p>This example is for the relatively common occurrence of CFD data that is purely nondimensional, for which the reference state is arbitrary (unknown). This type is referred to as NormalizedByUnknownDimensional. Another nondimensional type, NormalizedByDimensional, for which the data is nondimensional but the reference state is specifically known, is not covered here.</p>
<p>For a NormalizedByUnknownDimensional database, the DataClass is recorded as such, but also a ReferenceState is necessary to define the nondimensionalizations used. (A ReferenceState_t node can be used for any dataset to indicate the global reference state (such as free stream), as well as quantities such as the reference Mach number and Reynolds number. A ReferenceState_t node was not included in the previous section, but it could have been.)</p>
<p>For the current example, we do not go into detail regarding the choices of the items which should define the reference state for a NormalizedByUnknownDimensional database. We simply show in the example some typical choices which very often would likely be included. A detailed discussion of how the data in ReferenceState_t defines the nondimensionalizations is given in the SIDS document.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE NONDIMENSIONAL INFO</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   put DataClass under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NormalizedByUnknownDimensional</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   put ReferenceState under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_state_write_f</span><span class="p">(</span><span class="s1">&#39;ReferenceQuantities&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node, write Mach array and its dataclass</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmach</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node, write Reynolds array and its dataclass</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">reue</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node to write reference quantities:</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   First, write reference quantities that make up Mach and Reynolds:</span>
<span class="c">!   Mach_Velocity</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach_Velocity&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmv</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Mach_VelocitySound</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach_VelocitySound&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_Velocity</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_Velocity&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rev</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_Length</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_Length&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rel</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_ViscosityKinematic</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_ViscosityKinematic&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">renu</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Next, write flow field reference quantities:</span>
<span class="c">!   Density</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rho0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Pressure</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocitySound</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocitySound&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">c0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   ViscosityMolecular</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;ViscosityMolecular&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vm0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   LengthReference</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;LengthReference&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xlength0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityX</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityX&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityY</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityY&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityZ</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityZ&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vz</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the only information added to the CGNS file is at the CGNSBase_t level. Note that Mach and Reynolds (which are stored under ReferenceState) are variables that are known as “NondimensionalParameter”s, so they must each contain a DataClass child node stating this (the local DataClass nodes supersede the overall NormalizedByUnknownDimensional data class that holds for everything else).</p>
<p>The layout of the relevant portion of the resulting CGNS file from the above example is shown below. Many of the reference quantities that appear under ReferenceState_t have been left out of the figure to conserve space.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/tree_nondimensional.gif"><img alt="Diagram showing CGNS layout for nondimensional data with arbitrary reference state" src="../_images/tree_nondimensional.gif" style="width: 168px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file with purely nondimensional data (reference state unknown).</em></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="flow-equation-sets">
<h2>Flow Equation Sets<a class="headerlink" href="#flow-equation-sets" title="Permalink to this heading">¶</a></h2>
<p>The FlowEquationSet_t node is useful for describing how a flow solution was generated. This is one of the useful self-descriptive aspects of CGNS that may improve the usefulness and longevity of a CFD dataset. For example, under this node, information such as the following may be recorded: the flow field was obtained by solving the thin-layer Navier-Stokes equations (with diffusion only in the j-coordinate direction); the Spalart-Allmaras turbulence model was employed, and an ideal gas assumption was made with γ = 1.4.</p>
<p>The following FORTRAN code segment writes some of the above example flow equation set information under the Zone_t node from our earlier single-zone structured grid example. (Note that a FlowEquationSet_t node can also be placed at a higher level, under the CGNSBase_t node. The usual precedence rules apply).</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW EQUATION SET INFO</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">     </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   existing file must be 3D structured (real working code would check!)</span>
<span class="c">!   Create &#39;FlowEquationSet&#39; node under &#39;Zone_t&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   equation dimension = 3</span>
<span class="w">     </span><span class="n">ieq_dim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_equationset_write_f</span><span class="p">(</span><span class="n">ieq_dim</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Create &#39;GoverningEquations&#39; node under &#39;FlowEquationSet&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_governing_write_f</span><span class="p">(</span><span class="n">NSTurbulent</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;DiffusionModel&#39; node under &#39;GoverningEquations&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GoverningEquations_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_diffusion_write_f</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Create &#39;GasModel&#39; under &#39;FlowEquationSet&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_model_write_f</span><span class="p">(</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="n">Ideal</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;SpecificHeatRatio&#39; under GasModel</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;SpecificHeatRatio&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nb">gamma</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;DataClass&#39; under &#39;SpecificHeatRatio&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>This particular example is specific to a 3-D structured zone. In an unstructured zone, the use of DiffusionModel is not valid. The layout of the relevant portion of the resulting CGNS file from the above example is shown below.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/tree_floweqn.gif"><img alt="Diagram showing CGNS layout for flow equation set information" src="../_images/tree_floweqn.gif" style="width: 168px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file with flow equation set information.</em></span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="time-dependent-data">
<h2>Time-Dependent Data<a class="headerlink" href="#time-dependent-data" title="Permalink to this heading">¶</a></h2>
<p>Time-dependent data (data with multiple flow solutions) can also be stored in a CGNS file. Different circumstances may produce data with multiple flow solutions; for example:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Non-moving grid</p></li>
<li><p>Rigidly-moving grid</p></li>
<li><p>Deforming or changing grid</p></li>
</ol>
</div></blockquote>
<p>Each of these may either be the result of a time-accurate run, or else may simply be multiple snapshots of a non-time-accurate run as it iterates toward convergence.</p>
<p>This section gives an example for type 1 only. Readers interested in the two other types should refer to the SIDS document. For a non-moving grid, the method for storing the multiple flow solutions is relatively simple: multiple FlowSolution_t nodes, each with a different name, are placed under each Zone_t node. However, there also needs to be a mechanism for associating each FlowSolution_t with a particular time and/or iteration. This is accomplished through the use of BaseIterativeData_t (under CGNSBase_t) and ZoneIterativeData_t (under each Zone_t). BaseIterativeData_t contains NumberOfSteps, the number of times and/or iterations stored, and their values. ZoneIterativeData_t contains FlowSolutionPointers as a character data array. FlowSolutionPointers is dimensioned to be of size NumberOfSteps, and contains the names of the FlowSolution_t nodes within the current zone that correspond with the respective times and/or iterations. Finally, a SimulationType_t node is placed under CGNSBase_t to designate what type of simulation (e.g., TimeAccurate, NonTimeAccurate) produced the data. (Note: the SimulationType_t node is not restricted for use with time-dependent data; any CGNS dataset can employ it!)</p>
<p>The following FORTRAN code segment writes some of the above information, using our earlier single-zone structured grid example. For the purposes of this example, it is assumed that there are 3 flow solutions from a time-accurate simulation, to be output as a function of time to the CGNS file. The variables r1 and p1 represent the density and pressure at time 1, r2 and p2 are at time 2, and r3 and p3 are at time 3.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW SOLUTION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   set up the times corresponding to the 3 solutions to be</span>
<span class="c">!   stored:</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span><span class="mf">0.</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="mf">0.</span>
<span class="c">!   define 3 different solution names (user can give any names)</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution1&#39;</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution2&#39;</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution3&#39;</span>
<span class="c">!   do loop for the 3 solutions:</span>
<span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<span class="c">!   create flow solution node</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_sol_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">solname</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
<span class="w">    </span><span class="o">+</span><span class="w">     </span><span class="n">Vertex</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   write flow solution (user must use SIDS-standard names here)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r3</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">      enddo</span>
<span class="c">!   create BaseIterativeData</span>
<span class="w">      </span><span class="n">nsteps</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_biter_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="s1">&#39;TimeIterValues&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">nsteps</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to BaseIterativeData level and write time values</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;BaseIterativeData_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;TimeValues&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">time</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   create ZoneIterativeData</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_ziter_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;ZoneIterativeData&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to ZoneIterativeData level and give info telling which</span>
<span class="c">!   flow solution corresponds with which time (solname(1) corresponds</span>
<span class="c">!   with time(1), solname(2) with time(2), and solname(3) with time(3))</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;ZoneIterativeData_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">idata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">32</span>
<span class="w">      </span><span class="n">idata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;FlowSolutionPointers&#39;</span><span class="p">,</span><span class="kt">Character</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">solname</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   add SimulationType</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_simulation_type_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">TimeAccurate</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>As cautioned for earlier coding snippets, dimensions must be set appropriately for all variables. The variable time (which is an array dimensioned size 3 in this case) contains the time values stored under BaseIterativeData_t. The layout of the resulting CGNS file from the above example is shown below. Compare this figure with the layout of a CGNS file for a simple Cartesian structured grid with a single flow solution. To conserve space, the GridCoordinates_t, ZoneType_t, and all nodes underneath FlowSolution_t have been left off.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/tree_cartesian_soltime.gif"><img alt="Diagram showing CGNS layout for time-accurate flow solutions" src="../_images/tree_cartesian_soltime.gif" style="width: 168px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for simple Cartesian structured grid with multiple time-accurate flow solutions (non-moving grid coordinates)</em></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="using-links">
<h2>Using Links<a class="headerlink" href="#using-links" title="Permalink to this heading">¶</a></h2>
<p>A link associates one node to another within a CGNS tree, or even one node to another in a separate CGNS file altogether. This can be useful when there is repeated data; rather than write the same data multiple times, links can point to the data written only once.</p>
<p>One very important use of links that may be required by many users is to point to grid coordinates. This usage comes about in the following way. Suppose a user is planning to use a particular grid for multiple cases. There are several options for how to store the data. Among these are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Keep a copy of the grid with each flow solution in separate CGNS files.</p></li>
<li><p>Keep just one CGNS file, with the grid and multiple FlowSolution_t nodes; each FlowSolution_t node corresponds with a different case.</p></li>
<li><p>Keep just one CGNS file, with multiple CGNSBase_t nodes. The grid and one flow solution would be stored under one base. Other bases would each contain a separate flow solution, plus a link to the grid coordinates in the first base.</p></li>
<li><p>Keep one CGNS file with the grid coordinates defined, and store the flow solution for each case in its own separate CGNS file, with a link to the grid coordinates.</p></li>
</ol>
</div></blockquote>
<p>Item 1 is conceptually the most direct, and is certainly the recommended method in general (this is the way all example CGNS files have been portrayed so far in this document). However, if the grid is very large, then this method causes a lot of storage space to be unnecessarily used to store the same grid points multiple times. Item 2 may or may not be a viable option. If the user is striving to have the CGNS file be completely self-descriptive, with ReferenceState and FlowEquationSet describing the relevant conditions, then this method cannot be used if the ReferenceState or FlowEquationSet is different between the cases (for example, different Mach numbers, Reynolds numbers, or angles of attack). Item 3 removes this restriction. It uses links to the grid coordinates within the same file. Item 4 is similar to item 3, except that the grid coordinates and each flow solution are stored in separate files altogether.</p>
<p>A sample layout showing the relevant portions of two separate CGNS files for an example of item 4 is shown below. Note that for multiple-zone grids, each zone in FILE 1 in this example would have a separate link to the appropriate zone’s grid coordinates in FILE 2.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/tree_link.gif"><img alt="Diagram showing two CGNS files with a link from one to the other" src="../_images/tree_link.gif" style="width: 168px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of two CGNS files with a link from one to the grid coordinates of the other.</em></span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The CGNS API now has the capability to specify links and to query link information in a CGNS file. Previously this was only possible by use of the ADF core library software. However, when a CGNS file is open for writing and the link creation call is issued, the link information is merely recorded and the actual link creation is deferred until the file is written out upon closing it. Therefore, any attempt to go to a location in a linked file while the CGNS file is open for writing will fail. This problem does not exist when a CGNS file is open for modification as link creation is immediate.</p>
<p>Reading a linked CGNS file presents no difficulties for the API, because links are “transparent.” As long as any separate linked files keep their name unchanged, and maintain the same position (within the Unix-directory) relative to the parent file, opening the parent file will automatically access the linked ones.</p>
</section>
</section>


          </div>
            
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">CGNS Official Web Site</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Additional Information</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 1991-2020, CGNS Steering Commmittee. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>